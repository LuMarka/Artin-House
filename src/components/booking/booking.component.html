<section id="booking" class="booking">
  <div class="booking__container">
    <h2 class="booking__title">{{ t.title() }}</h2>
    <div class="booking__content">
      <!-- Calendar -->
      <div class="booking__calendar">
        <div class="booking__calendar-header">
          <button (click)="changeMonth(-1)" class="booking__calendar-nav">
            <svg class="booking__calendar-nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
          </button>
          <h3 class="booking__calendar-month">{{ monthYearDisplay() }}</h3>
          <button (click)="changeMonth(1)" class="booking__calendar-nav">
            <svg class="booking__calendar-nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
          </button>
        </div>
        <div class="booking__weekdays">
          <div>{{ t.weekdays.sun() }}</div><div>{{ t.weekdays.mon() }}</div><div>{{ t.weekdays.tue() }}</div><div>{{ t.weekdays.wed() }}</div><div>{{ t.weekdays.thu() }}</div><div>{{ t.weekdays.fri() }}</div><div>{{ t.weekdays.sat() }}</div>
        </div>
        <div class="booking__calendar-grid">
          @for (week of calendarGrid(); track $index) {
            @for (day of week; track day.date) {
              <div 
                (click)="selectDate(day)"
                [class]="{
                  'booking__calendar-day--selectable': day.isCurrentMonth && !day.isBooked && !day.isPast,
                  'booking__calendar-day--other-month': !day.isCurrentMonth,
                  'booking__calendar-day--current-month': day.isCurrentMonth,
                  'booking__calendar-day--booked': day.isBooked,
                  'booking__calendar-day--past': day.isPast,
                  'booking__calendar-day--selected': isDateSelected(day.date),
                  'booking__calendar-day--in-range': isDateInRange(day.date)
                }"
                class="booking__calendar-day">
                {{ day.date.getDate() }}
              </div>
            }
          }
        </div>
      </div>
      <!-- Booking Form -->
      <div class="booking__form">
        <h3 class="booking__form-title">{{ t.subtitle() }}</h3>
        
        <div class="booking__field">
          <label class="booking__label">{{ t.apartmentLabel() }}</label>
          <select [ngModel]="selectedApartment()" (ngModelChange)="selectedApartment.set($event); onApartmentChange()" class="booking__select">
            <option value="Artin House I">Artin House I</option>
            <option value="Artin House II">Artin House II</option>
          </select>
        </div>
        
        <div class="booking__dates">
          <div class="booking__date-field">
            <label class="booking__label">{{ t.checkinLabel() }}</label>
            <div class="booking__date-display">
              {{ checkInDate() ? (checkInDate() | date:'shortDate':undefined:language()) : t.selectDate() }}
            </div>
          </div>
          <div class="booking__date-field">
            <label class="booking__label">{{ t.checkoutLabel() }}</label>
            <div class="booking__date-display">
              {{ checkOutDate() ? (checkOutDate() | date:'shortDate':undefined:language()) : t.selectDate() }}
            </div>
          </div>
        </div>

        <!-- Guest Counter -->
        <div class="booking__guests">
          <label class="booking__label">{{ t.guestLabel() }}</label>
          <div class="booking__guest-counter">
            <button 
              type="button" 
              (click)="decrementGuests()" 
              [disabled]="guests() <= 1"
              class="booking__counter-btn">
              <svg class="booking__counter-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"/>
              </svg>
            </button>
            <span class="booking__guest-count">{{ guests() }} {{ guests() === 1 ? 'persona' : 'personas' }}</span>
            <button 
              type="button" 
              (click)="incrementGuests()" 
              [disabled]="guests() >= maxGuests()"
              class="booking__counter-btn">
              <svg class="booking__counter-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
              </svg>
            </button>
          </div>
          <div class="booking__price-display">
            <span class="booking__price-per-night">${{ pricePerNight().toLocaleString() }} ARS por noche</span>
            @if (numberOfNights() > 0) {
              <span class="booking__total-price">Total: ${{ totalPrice().toLocaleString() }} ARS</span>
            }
          </div>
        </div>
        
        @if (numberOfNights() > 0) {
          <div class="booking__nights-info">
            <p class="booking__nights-text">
              {{ t.totalStay() }}: {{ numberOfNights() }} {{ numberOfNights() === 1 ? t.nights().slice(0, -1) : t.nights() }}
            </p>
          </div>
        }

        <div class="booking__buttons">
          <button (click)="confirmBooking()" class="booking__submit-button booking__submit-button--primary">
            {{ t.bookButton() }}
          </button>
        </div>

        @if (bookingStatus() === 'booked') {
          <div class="booking__message booking__message--success">
            <p class="booking__success-message">
            {{ t.confirmationMessage() }}
          </p>
          </div>
        }
        @if (bookingStatus() === 'error') {
          <div class="booking__message booking__message--error">
            {{ t.errorMsg() }}
          </div>
        }
      </div>
    </div>

    <!-- Payment Information Section -->
    <div class="booking__payment-section">
      <div class="booking__payment-container">
        
        <div class="booking__payment-info">
          <div class="booking__payment-methods">
            <h4 class="booking__payment-subtitle">{{ t.payment.methods() }}</h4>
            <div class="booking__payment-options">
              <span class="booking__payment-option">{{ t.payment.creditCard() }}</span>
              <span class="booking__payment-option">{{ t.payment.debitCard() }}</span>
              <span class="booking__payment-option">{{ t.payment.bankTransfer() }}</span>
              <span class="booking__payment-option">{{ t.payment.cash() }}</span>
            </div>
          </div>
          <div class="booking__payment-terms">
            <h4 class="booking__payment-subtitle">{{ t.payment.information() }}</h4>
            <p class="booking__payment-text">
              <strong>{{ t.payment.deposit() }}</strong> {{ t.payment.depositAmount() }}<br>
              <strong>{{ t.payment.checkinTime() }}</strong> {{ t.payment.checkinValue() }}<br>
              <strong>{{ t.payment.checkoutTime() }}</strong> {{ t.payment.checkoutValue() }}<br>
              <strong>{{ t.payment.discountInfo() }}</strong> {{ t.payment.discountValue() }}
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>